<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Promise Methods - all, race, allSettled</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>ğŸš€ Promise Utility Methods</h1>
      <p>Promise.all, Promise.race, Promise.allSettled</p>
    </header>

    <main>
      <!-- Overview -->
      <section class="section">
        <h2>ğŸ’¡ Overview</h2>
        <p class="section-desc">Promise utility methods let you work with multiple promises at once!</p>
        
        <div class="methods-grid">
          <div class="method-card all">
            <div class="method-icon">ğŸ¯</div>
            <h3>Promise.all()</h3>
            <p>Wait for ALL to complete</p>
            <span class="method-note">Fails fast if any fails</span>
          </div>
          <div class="method-card race">
            <div class="method-icon">ğŸƒ</div>
            <h3>Promise.race()</h3>
            <p>First one to complete wins</p>
            <span class="method-note">Returns first settled</span>
          </div>
          <div class="method-card settled">
            <div class="method-icon">ğŸ“Š</div>
            <h3>Promise.allSettled()</h3>
            <p>Get all results regardless</p>
            <span class="method-note">Never rejects</span>
          </div>
        </div>
      </section>

      <!-- Promise.all Demo -->
      <section class="section">
        <h2>ğŸ¯ Promise.all() - All or Nothing</h2>
        <p class="section-desc">Waits for all promises to fulfill. If ANY promise rejects, the whole thing rejects immediately!</p>
        
        <div class="code-block">
          <div class="code-header">
            <span class="badge badge-all">Promise.all</span>
            Parallel Execution
          </div>
          <pre><code>// All three run in PARALLEL! ğŸš€
const [user, posts, settings] = await Promise.all([
  fetchUser(1),      // 800ms
  fetchPosts(),      // 600ms
  fetchSettings()    // 400ms
]);
// Total time: ~800ms (not 1800ms!)

// âš ï¸ If ANY fails, entire Promise.all fails!</code></pre>
        </div>

        <div class="demo-controls">
          <button id="runAllSuccess" class="btn btn-all">
            âœ… Run All (Success)
          </button>
          <button id="runAllFail" class="btn btn-danger">
            âŒ Run All (With Failure)
          </button>
        </div>

        <div class="progress-container" id="allProgress">
          <div class="progress-bar" id="allBar1">
            <span class="progress-label">User</span>
            <div class="progress-fill" id="allFill1"></div>
          </div>
          <div class="progress-bar" id="allBar2">
            <span class="progress-label">Posts</span>
            <div class="progress-fill" id="allFill2"></div>
          </div>
          <div class="progress-bar" id="allBar3">
            <span class="progress-label">Settings</span>
            <div class="progress-fill" id="allFill3"></div>
          </div>
        </div>
        <div id="allOutput" class="output"></div>
      </section>

      <!-- Promise.race Demo -->
      <section class="section">
        <h2>ğŸƒ Promise.race() - First Wins</h2>
        <p class="section-desc">Returns the result of the FIRST promise to settle (fulfill or reject).</p>
        
        <div class="code-block">
          <div class="code-header">
            <span class="badge badge-race">Promise.race</span>
            First One Wins
          </div>
          <pre><code>// Race between servers - use fastest response!
const fastest = await Promise.race([
  fetchFromServer1(),  // 500ms
  fetchFromServer2(),  // 300ms  â† WINNER!
  fetchFromServer3()   // 700ms
]);

console.log(fastest); // Result from Server 2</code></pre>
        </div>

        <div class="demo-controls">
          <button id="runRace" class="btn btn-race">
            ğŸƒ Run Race
          </button>
          <button id="runRaceTimeout" class="btn btn-warning">
            â° Race with Timeout
          </button>
        </div>

        <div class="race-container" id="raceProgress">
          <div class="race-lane">
            <span class="lane-label">Server 1</span>
            <div class="race-track">
              <div class="race-runner" id="runner1">ğŸš—</div>
            </div>
            <span class="lane-time" id="time1"></span>
          </div>
          <div class="race-lane">
            <span class="lane-label">Server 2</span>
            <div class="race-track">
              <div class="race-runner" id="runner2">ğŸš•</div>
            </div>
            <span class="lane-time" id="time2"></span>
          </div>
          <div class="race-lane">
            <span class="lane-label">Server 3</span>
            <div class="race-track">
              <div class="race-runner" id="runner3">ğŸš™</div>
            </div>
            <span class="lane-time" id="time3"></span>
          </div>
        </div>
        <div id="raceOutput" class="output"></div>
      </section>

      <!-- Promise.allSettled Demo -->
      <section class="section">
        <h2>ğŸ“Š Promise.allSettled() - Get Everything</h2>
        <p class="section-desc">Gets results from ALL promises, regardless of whether they succeed or fail.</p>
        
        <div class="code-block">
          <div class="code-header">
            <span class="badge badge-settled">Promise.allSettled</span>
            All Results
          </div>
          <pre><code>const results = await Promise.allSettled([
  fetchUser(1),    // âœ… Succeeds
  fetchUser(-1),   // âŒ Fails
  fetchUser(2)     // âœ… Succeeds
]);

// results = [
//   { status: 'fulfilled', value: {...} },
//   { status: 'rejected', reason: Error },
//   { status: 'fulfilled', value: {...} }
// ]

results.forEach((result, i) => {
  if (result.status === 'fulfilled') {
    console.log(`User ${i}: `, result.value);
  } else {
    console.log(`User ${i} failed: `, result.reason);
  }
});</code></pre>
        </div>

        <div class="demo-controls">
          <button id="runSettled" class="btn btn-settled">
            ğŸ“Š Run AllSettled
          </button>
        </div>

        <div class="settled-container" id="settledProgress">
          <div class="settled-item" id="settled1">
            <span class="settled-label">Request 1</span>
            <span class="settled-status">â³</span>
          </div>
          <div class="settled-item" id="settled2">
            <span class="settled-label">Request 2</span>
            <span class="settled-status">â³</span>
          </div>
          <div class="settled-item" id="settled3">
            <span class="settled-label">Request 3</span>
            <span class="settled-status">â³</span>
          </div>
        </div>
        <div id="settledOutput" class="output"></div>
      </section>

      <!-- Comparison Table -->
      <section class="section">
        <h2>ğŸ“‹ When to Use Each</h2>
        <table class="comparison-table">
          <thead>
            <tr>
              <th>Method</th>
              <th>Use When</th>
              <th>Behavior</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>Promise.all()</code></td>
              <td>You need ALL results to proceed</td>
              <td>Fails fast if any fails</td>
            </tr>
            <tr>
              <td><code>Promise.race()</code></td>
              <td>You only need the first result</td>
              <td>Returns first settled</td>
            </tr>
            <tr>
              <td><code>Promise.allSettled()</code></td>
              <td>You want all results, even failures</td>
              <td>Always resolves with array</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- Sequential vs Parallel -->
      <section class="section">
        <h2>âš¡ Sequential vs Parallel</h2>
        <div class="vs-container">
          <div class="vs-card bad">
            <h4>âŒ Sequential (Slow)</h4>
            <div class="mini-code">
const user = await fetchUser(1);     // 800ms
const posts = await fetchPosts();    // +600ms
const comments = await fetchComments(); // +500ms
// Total: 1900ms ğŸŒ
            </div>
            <div class="timing-visual">
              <div class="timing-bar" style="width: 40%;">User</div>
              <div class="timing-bar" style="width: 30%; margin-left: 40%;">Posts</div>
              <div class="timing-bar" style="width: 25%; margin-left: 70%;">Comments</div>
            </div>
          </div>
          
          <div class="vs-card good">
            <h4>âœ… Parallel (Fast)</h4>
            <div class="mini-code">
const [user, posts, comments] = await Promise.all([
  fetchUser(1),      // 800ms
  fetchPosts(),      // 600ms
  fetchComments()    // 500ms
]);
// Total: ~800ms ğŸš€
            </div>
            <div class="timing-visual parallel">
              <div class="timing-bar" style="width: 40%;">User</div>
              <div class="timing-bar" style="width: 30%;">Posts</div>
              <div class="timing-bar" style="width: 25%;">Comments</div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>Chapter 17: Async/Await Complete Guide</p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
